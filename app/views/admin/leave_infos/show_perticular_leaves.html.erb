
<div class="container">
  <div class="row-fluid">
    <div class="span12 well">
      <center><legend>Listing leave_infos</legend></center>
      <%= render :partial => "leave_show" %>
      <table class ="table">
        <tr>
          <th>Applicant Name</th>
          <th>Refferal Name</th>
          <th>Reference Status</th>
          <th>Start Date</th>
          
          <th>End Date</th>
          <th>Leave Days</th>
          <th>Status Of Day</th>
          <th>Leave Status</th>
          <th>Counted Leave</th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
        <% count = 0 %>
        <% total_count = 0%>
      <% @leave_infos.each do |leave_info| %>
        <tr>
          <% @e = Employee.find_by_id(leave_info.applicant_id) %>
          <td>
          <%# unless @e.personal_info.blank? %>
            <%= @e.personal_info.name  %>
          <%# end %>
          </td> 
          <% if(leave_info.applicant_id == leave_info.employee_id) %>
            <td> Same </td>
          <% else %>  
            <% @l = Employee.find_by_id(leave_info.employee_id) %>
            <td><%= @l.personal_info.name %>
          <% end %>
          <td><%= leave_info.reference_status %></td>                 
          <td><%= leave_info.start_date %></td>
          <td><%= leave_info.end_date %></td>
          <td><%= count += distance_of_time_in_words(leave_info.start_date ,leave_info.end_date).to_i  %></td>
          <td><%= leave_info.status_of_day %></td>
          <td><%= leave_info.leave_status %></td>
          <td><%= counted_leave = count * leave_info.status_of_day %></td>
          <% total_count += counted_leave %>

          <td><%= link_to 'Show', admin_leave_info_path(leave_info), :class => "btn btn-info" %></td>
          <td><%= link_to 'Status', edit_admin_leave_info_path(leave_info), :class => "btn btn-info" %></td>
        </tr>
      <% end %>
      </table>
      <br />
      <b>Total leave</b>
      <%= total_count %>
    </div>
  </div>
</div>

